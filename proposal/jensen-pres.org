#+AUTHOR: Andrew Jensen
#+TITLE: Joint Track Machine Learning
#+DATE: March 9, 2023
#+BIBLIOGRAPHY: ../src/myBib.bib
#+DESCRIPTION:
#+KEYWORDS:
#+LANGUAGE:  en
#+OPTIONS:   H:2 num:t toc:t \n:nil @:t ::t |:t ^:t -:t f:t *:t <:t
#+OPTIONS:   TeX:t LaTeX:t skip:nil d:nil todo:t pri:nil tags:not-in-toc
#+EXPORT_SELECT_TAGS: export
#+EXPORT_EXCLUDE_TAGS: noexport
#+HTML_LINK_UP:
#+HTML_LINK_HOME:

#+startup: beamer
#+LaTeX_CLASS: beamer

#+options: H:3
#+latex_class: beamer
#+LaTeX_CLASS_OPTIONS: [presentation, aspectratio=1610]
#+columns: %45ITEM %10 BEAMER_env(Env) %10BEAMER_act(Act) %4BEAMER_col(Col) %8BEAMER_opt(Opt)
#+beamer_theme: metropolis
#+latex_header: \usetheme[progressbar=foot]{metropolis}
#+latex_header_extra: \usepackage{caption}
#+latex_header_extra: \captionsetup[figure]{labelformat=empty}
#+latex_header_extra: \AtBeginSubsection{\begin{frame}\tableofcontents[currentsection,currentsubsection]\end{frame}}
#+beamer_color_theme:
#+beamer_font_theme:
#+beamer_inner_theme:
#+beamer_outer_theme:

* Introduction
*** Acknowledgments
I would like to thank the McJunkin Family Charitable Foundation for their generous grant that supports this work.
* Motivation
*** The Problem
**** :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.5
:END:
+ 20% of patients receiving TKA are dissatisfied.
  + Instability, pain, unnatural [cite:@bakerRolePainFunction2007; @bournePatientSatisfactionTotal2010; @scottPredictingDissatisfactionFollowing2010].
+ No reliable method of clinically assessing and quantifying joint dynamics.
  + Too much human supervision, too time consuming
**** :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.5
:END:
#+ATTR_LaTeX: :width \textwidth
[[file:~/repo/lit-review/figures/raster/Physical_Examination_of_the_knee.jpg]]
*** Our Proposition
**** :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.5
:END:
Orthopaedic surgeons and clinicians would readily adopt a practical and inexpensive technology that allows them to measure a patient's knee kinematics during activities of daily living.
**** :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.55
:END:
#+ATTR_LaTeX: :width 2in
[[file:~/repo/lit-review/figures/raster/dynamic-knee-prescription.png]]
*** Constraints
**** :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.45
:END:
+ It must fit within a standard clinical workflow
+ The technology must utilize equipment commonly found in hospitals
+ There must not be significant human supervision nor interaction to generate an examination report.
**** :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.55
:END:
#+ATTR_LaTeX: :width \textwidth
[[file:~/repo/lit-review/figures/raster/c-arm-fluoro-machine.jpg]]
* Background
*** Rigid Body Transformations
**** Translation :B_block:
:PROPERTIES:
:BEAMER_env: block
:END:
#+begin_src latex
\begin{equation*}
  \begin{aligned}
  \begin{pmatrix}
    v_{x}' \\ v_{y}'
  \end{pmatrix} &=
  \begin{pmatrix}
    v_{x} \\ v_{y}
  \end{pmatrix} +
  \begin{pmatrix}
    t_{x} \\ t_{y}
  \end{pmatrix} \\
                & \rightarrow \\
    \begin{pmatrix}
      v_{x}' \\ v_{y}' \\ 1
    \end{pmatrix} &=
                    \begin{pmatrix}
                      1 & 0 & t_{x} \\ 0 & 1 & t_{y} \\ 0 & 0 & 1
                    \end{pmatrix}
                                                                \begin{pmatrix}
                                                                  v_{x} \\ v_{y} \\  1
                                                                \end{pmatrix}
\end{aligned}
\end{equation*}
#+end_src
*** Rigid Body Transformations
**** Rotations :B_block:
:PROPERTIES:
:BEAMER_env: block
:END:
#+begin_src latex
\begin{equation*}
  \begin{aligned}
    R_{x} & =
            \begin{pmatrix}
              1 & 0 & 0 \\
              0 & c_{x} & -s_{x}\\
              0 & s_{x} & c_{x}
            \end{pmatrix} \\
    R_{y} &=
            \begin{pmatrix}
              s_{y} & 0 & c_{y}\\
              0 & 1 & 0 \\
              c_{y} & 0 & -s_{y}
            \end{pmatrix} \\
    R_{z} &=
            \begin{pmatrix}
              c_{z} & -s_{z} & 0 \\
              s_{z} & c_{z} & 0 \\
              0 & 0 & 1
            \end{pmatrix}
  \end{aligned}
\end{equation*}
#+end_src
*** Rigid Body Transformations
**** Homogeneous Transformation Matrices :B_block:
:PROPERTIES:
:BEAMER_env: block
:END:
#+begin_src latex
\begin{equation*}
  \begin{aligned}
  \tilde{\vec{v'}} &=
  \begin{pmatrix}
    & \mathbf{R}_{3 \times 3} & & \vec{t}_{3 \times 1} \\
    0 & 0 & 0 & 1
  \end{pmatrix}\tilde{\vec{v}} \\
    &= T^{A}_{B} \tilde{\vec{v}}
  \end{aligned}
\end{equation*}
#+end_src
Now we have a notation that allows us to describe arbitrary movement between reference frames.
*** Projective Geometry
**** :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.5
:END:
#+begin_src latex
\begin{equation*}
  \begin{pmatrix}
    x_{s} \\ y_{s} \\ z_{s} \\ 1
  \end{pmatrix}_{i} = T^{cam}_{scene} \mathbf{\tilde{p}^{obj}_{i}}
\end{equation*}
#+end_src
#+begin_src latex
\begin{equation*}
  \begin{pmatrix}
    \tilde{x}_{img} \\ \tilde{y}_{img} \\ \tilde{z}
  \end{pmatrix} =
  \begin{pmatrix}
    f& 0 & 0 \\ 0 & f & 0 \\ 0 & 0 & 1
  \end{pmatrix} \vec{x}_{s}
\end{equation*}

Where
\begin{equation*}
  \begin{aligned}
    x_{img} &= \frac{\tilde{x_{img}}}{\tilde{z}} = \frac{f}{z_{s}}x_{s} \\
    y_{img} &= \frac{\tilde{y_{img}}}{\tilde{z}} = \frac{f}{z_{s}}y_{s}
  \end{aligned}
\end{equation*}

{\tiny Note: We are still in the camera's reference frame}
#+end_src
**** :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.6
:END:
[[file:~/repo/lit-review/figures/raster/perspective-projection.png]]
*** Pixel Coordinates
Convert camera coordinates into image coordinates.
#+begin_src latex
\begin{equation*}
  \begin{aligned}
    p_{x} = k_{x}x_{img} + c_{x} \\
    p_{y} = k_{y}y_{img} + c_{y}
  \end{aligned}
\end{equation*}
Where
\begin{equation*}
  \begin{aligned}
    k &\equiv \text{ Pixel Spacing }\\
    c &\equiv \text{ Image Focal Point }
  \end{aligned}
\end{equation*}
#+end_src
*** Model-Image Registration
**** :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.5
:END:
If we know the projective parameters of the fluoroscopy machine, can we tinker with $T^{cam}_{implant}$ so that our virtual projection matches the fluoroscopic image?
**** :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.6
:END:
#+ATTR_latex: :width 2.5in
#+CAPTION:From [cite:@mahfouzRobustMethodRegistration2003]
file:~/repo/lit-review/figures/raster/mahfouz-perspective-projection.png
* Historical Methods
*** Overview
Many different approaches have attempted to solve the model-image registration problem.
+ Pre-computed projections
+ Skin-mounted motion Capture
+ Biplane Imaging
+ Iterative Projections
+ Model-based Roentgen Stereophotogrammetry
*** Pre-Computed Projections
**** :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.5
:END:
+ Saving space and memory by pre-computing as much as possible.
+ Pre-computed distance maps [cite:@zuffiModelbasedMethodReconstruction1999; @lavalleeRecoveringPositionOrientation1995].
+ Pre-computed shape libraries [cite:@banksAccurateMeasurementThreedimensional1996]
**** :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.6
:END:
#+ATTR_LaTeX: :width 1.75in
#+CAPTION: From [cite:@lavalleeRecoveringPositionOrientation1995]
[[file:~/repo/lit-review/figures/raster/lavallee-distance-maps.png]]
\vspace{-0.25in}
#+ATTR_LaTeX: :width 1.75in
#+CAPTION: From [cite:@banksAccurateMeasurementThreedimensional1996]
[[file:~/repo/lit-review/figures/raster/banks-nfd-library.png]]
*** Limitations of Pre-Computed Projections
+ Requires an accurate contour from the input image in order to perform calculations.
  + Human supervision vs. inaccuracy.

*** Motion Capture (MoCap)
**** :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.5
:END:
+ Can measure motion of MoCap beads very accurately.
+ Skin-mounted [cite:@gaoInvestigationSoftTissue2008; @kuoInfluenceSoftTissue2011; @linEffectsSoftTissue2016].
+ Bone pins [cite:@lafortuneThreedimensionalKinematicsHuman1992] (any volunteers?).

**** :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.6
:END:
#+ATTR_LaTeX: :width 2.5in
#+CAPTION: From [cite:@gaoInvestigationSoftTissue2008]
[[file:~/repo/lit-review/figures/raster/gao-skin-mocap.png]]
\vspace{-0.25in}
#+ATTR_LaTeX: :width 2.5in
#+CAPTION: From [cite:@lafortuneThreedimensionalKinematicsHuman1992]
[[file:~/repo/lit-review/figures/raster/lafortune-bone-mocap.png]]
*** Limitations of Motion Capture
Skin Mounted
+ Doesn't accurately describe underlying skeletal motion with clinical accuracy [cite:@gaoInvestigationSoftTissue2008; @kuoInfluenceSoftTissue2011; @linEffectsSoftTissue2016].
Bone Pins
+ Bone Pins
+ Need I say more?
*** Biplane Imaging
**** :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.5
:END:
#+ATTR_LaTeX: :width \textwidth
+ Utilizes multiple cameras to resolve 3D position and orientation[cite:@ivesterReconfigurableHighSpeedStereoRadiography2015; @burtonAutomaticTrackingHealthy2021].
  + Highly accurate.
  + Gold Standard.
**** :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.6
:END:
#+ATTR_LaTeX: :width 1.75in
#+CAPTION: Both from [cite:@ivesterReconfigurableHighSpeedStereoRadiography2015]
[[file:~/repo/lit-review/figures/raster/ivester-stereo-fluoromachine.png]]
\vspace{-0.25in}
#+ATTR_LaTeX: :width 1.75in
#+CAPTION:
[[file:~/repo/lit-review/figures/raster/ivester-stereo-projection.png]]
*** Limitations of Biplane Imaging
+ Not many hospitals have biplane fluoroscopy setups.
+ Clinically impractical

*** Iterative Projections
**** :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.54
:END:
+ Take advantage of modern computational graphics pipelines to quickly perform projection matching.
  + Image/Intensity similarity metrics [cite:@mahfouzRobustMethodRegistration2003]
  + Feature/Contour similarity metrics [cite:@floodAutomatedRegistration3D2018]
**** :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.6
:END:
#+ATTR_LaTeX: :width 2in
#+CAPTION: From [cite:@mahfouzRobustMethodRegistration2003]
[[file:~/repo/lit-review/figures/raster/mahfouz-perspective-projection.png]]
#+ATTR_LaTeX: :width 2in
#+CAPTION: From [cite:@floodAutomatedRegistration3D2018]
[[file:~/repo/lit-review/figures/raster/flood-dilated-contour.png]]
*** Limitations of (historic) Iterative Projection Methods
+ Requires human supervision for:
  + Pose initialization
  + Escaping local minima
  + Implant detection
+ Chaotic and Noisy objective function

*** Model-based Roentgen Stereophotogrammetry (MBRSA)
**** :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.5
:END:
+ Uses implanted tantalum beads for motion tracking [cite:@vroomanFastAccurateAutomated1998; @selvikRoentgenStereophotogrammetryMethod1989]
+ Extremely accurate [cite:@kapteinEvaluationThreePose2004; @saariKneeKinematicsMedial2005]
+ Gold standard Measurement [cite:@brobergValidationMachineLearning2023]

**** :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.6
:END:
#+ATTR_latex: :width 3in
#+CAPTION: From [cite:@vroomanFastAccurateAutomated1998]
[[file:~/repo/lit-review/figures/raster/vrooman-mbrsa.png]]
*** Limitations of MBRSA
+ Involves additional surgical procedures for inserting tantalum beads
+ Human supervision
+ Typically requires bi-plane imaging.

* Aims
*** Aims
**** Aims 1/2 :B_block:BMCOL:
:PROPERTIES:
:BEAMER_col: 0.3
:BEAMER_env: block
:END:
Joint Track Machine Learning and Overcoming Single-Plane Limitations
**** Aim 3/4 :B_block:BMCOL:
:PROPERTIES:
:BEAMER_col: 0.3
:BEAMER_env: block
:END:
Pilot Trials and Standardized Kinematics Exam
**** Aim 5 :B_block:BMCOL:
:PROPERTIES:
:BEAMER_col: 0.3
:BEAMER_env: block
:END:
Joint Track Auto Toolkit

** Aim 1 - Joint Track Machine Learning
*** Goal
Demonstrate the feasibility of a fully autonomous, model-image registration pipeline.
*** Method
+ Three-tiered approach
  + Convolutional Neural networks (CNN) for autonomous implant detection
  + Normalized Fourier Descriptor shape libraries
  + Robust contour-based global optimization scheme
[[file:~/repo/lit-review/figures/raster/pipeline-nocite.png]]
*** Autonomous Implant Detection Using Convolutional Neural Networks

**** :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.5
:END:
+ 2 CNNs
  + Femoral and Tibial implants
+ High Resolution Network [cite:@wangDeepHighResolutionRepresentation2020]
**** :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.5
:END:
#+ATTR_latex: :width \columnwidth
[[file:~/repo/lit-review/figures/raster/jtml-segmentation.png]]
*** Neural Network Data
**** :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.5
:END:
+ ~8000 images
  + 7 TKA kinematics studies
  + PUT DATA INFO HERE!!!!!

**** :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.6
:END:
#+ATTR_latex: :height 3in
[[file:~/repo/lit-review/figures/raster/jtml-data.png]]
*** Neural Network Robustness
+ Additional augmentations introduced during training [cite:@buslaevAlbumentationsFastFlexible2020].
[[file:~/repo/lit-review/figures/raster/augmentations.png]]
*** Normalized Fourier Descriptor Shape Libraries
**** :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.37
:END:
+ Pose initialization using segmentation output.
+ $\pm 30^{\circ}$ library span at $3^{\circ}$ increments.

**** :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.7
:END:
#+ATTR_latex: :width 2in
[[file:~/repo/lit-review/figures/raster/banks-nfd-library.png]]
#+ATTR_latex: :width 3.25in
[[file:~/repo/lit-review/figures/raster/jtml-nfd.png]]
** Aim 2 - Overcoming Single-Plane Symmetry Traps
** Aim 3 - Pilot Human Study
** Aim 4 - Standardized Kinematics Exam
** Aim 5 - Joint Track Auto Toolkit

* References
*** References
:PROPERTIES:
:BEAMER_OPT: fragile, allowframebreaks, label=
:END:
#+begin_src latex
\AtNextBibliography{\tiny}
\printbibliography
#+end_src
